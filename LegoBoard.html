<!DOCTYPE html>
<html>
  <head>
	<title>Lego Game of NCCU CS</title>
	<meta name="viewprot" content="width=device-width, initial-scale=1.0" />
	<!-- Bootstrap -->
	<link href="css/bootstrap.min.css" rel="stylesheet" media="screen"/>
	<link href="css/nccucsLego.css" rel="stylesheet" type="text/css">
	<link href="colorPicker/jquery.minicolors.css" rel="stylesheet" type="text/css">
	<script src="http://www.parsecdn.com/js/parse-1.2.8.min.js"></script>
	<script src="js/jquery.js"></script>
	<script type="text/javascript" src="js/bootstrap.min.js"></script>
	<script type="text/javascript" src="colorPicker/jquery.minicolors.js"></script>
	<script type="text/javascript" src="js/cslego.js"></script>
  </head>
  <body>
  	<script>
  		
		//初始化Parse的設定
		Parse.initialize("tbimiY2A0KZHiBWmec5feWnyV08gCXmxGAMNOe2Q", "ml4SiRmPnoEsa8IVFd0DBlbdVgazqLKzTaEyDD05");
		
  	</script>
  	<div id="fb-root"></div>
	<script>
	  window.fbAsyncInit = function() {
		// init the FB JS SDK
		FB.init({
		  appId      : 654164507933619,                      // App ID from the app dashboard
		  channelUrl : '//WWW.YOUR_DOMAIN.COM/channel.html', // Channel file for x-domain comms
		  status     : true,                                 // Check Facebook Login status
		  xfbml      : true                                  // Look for social plugins on the page
		});

		// Additional initialization code such as adding Event Listeners goes here

		//判斷登入狀態，決定login button的樣貌
		FB.getLoginStatus(function(response) {
		
			if (response.status === 'connected') {
				
				//如果已經授權而且登入，那就直接把#loginButton改成logout狀態
				var uid = response.authResponse.userID;
				var accessToken = response.authResponse.accessToken;
				
				$("#loginButton").html('Facebook Logout');
				$("#loginButton").removeClass('btn-primary').addClass('btn-inverse');
				
				var userName;
				
				FB.api('/me', function(response) {
					userName = response.name;
					$('#welcome').html("Welcome! " + userName);
				});
				
			} else if (response.status === 'not_authorized') {
			
				// the user is logged in to Facebook, 
				// but has not authenticated your app
				
				 FB.login(function(response) {
				   if (response.authResponse) {
					 
					 //使用者已經登入授權，改變button
					$("#loginButton").html('Facebook Logout');
					$("#loginButton").removeClass('btn-primary').addClass('btn-inverse');
					
					var userName;
				
					FB.api('/me', function(response) {
						userName = response.name;
						$('#welcome').html("Welcome! " + userName);
					});
					 
				   } else {
					 
					 //使用者拒絕登入，button一樣是login
					alert("Please authenticate this application, or you will not be able to create the new lego of your own!");
					window.location = 'LegoBoard.html';
					 
				   }
				 });
				
				
			}else {
				
				// the user isn't logged in to Facebook.
				
				FB.login(function(response) {
				   if (response.authResponse) {
					 
					 //使用者已經登入授權，改變button
					$("#loginButton").html('Facebook Logout');
					$("#loginButton").removeClass('btn-primary').addClass('btn-inverse');
					
					var userName;
				
					FB.api('/me', function(response) {
						userName = response.name;
						$('#welcome').html("Welcome! " + userName);
					});
					 
				   } else {
					 
					//使用者拒絕登入，button一樣是login
					alert("Please log in to Facebook, or you will not be able to create the new lego of your own!");
				
					window.location = 'LegoBoard.html';
					 
				   }
				 });
				
		  	}
		  	
		 });

	  };

	  // Load the SDK asynchronously
	  (function(d, s, id){
		 var js, fjs = d.getElementsByTagName(s)[0];
		 if (d.getElementById(id)) {return;}
		 js = d.createElement(s); js.id = id;
		 js.src = "//connect.facebook.net/en_US/all.js";
		 fjs.parentNode.insertBefore(js, fjs);
	   }(document, 'script', 'facebook-jssdk'));
	   
	</script>
	<header>
		<h1 class="text-left">NCCUCS LEGO BOARD<br/><small>Choose the shape, <br/>Pick the color, <br/>Instantly build your own CS logo!</small></h1>
		<div class="floatRight">
			<button class="btn btn-primary floatRight buttonMargin" id="loginButton">Facebook Login</button>
			<br/>
			<span id="welcome" class="floatRight spanMargin"></span>
		</div>
	</header>
	<div class="container-fluid">
		<div class="row-fluid">
			<div class="span2">
				<h4>Choose the shape:</h4>
				<table class="miniPicker inputFather">
					<tr>
						<td id="leftTop"><div></div></td>
						<td><div></div></td>
						<td id="rightTop"><div></div></td>
					</tr>
					<tr>
				        <td><div></div></td>
						<td id="center"><div></div></td>
						<td><div></div></td>
					</tr>
					<tr>
						<td id="leftBottom"><div></div></td>
						<td><div></div></td>
						<td id="rightBottom"><div></div></td>
					</tr>
				</table>
				<h4>Pick the color:</h4>
				<p class="inputFather">
					<input class="minicolors inline customize" type="text" value="#3b98bd">
				</p>
			</div>
			<div class="span10">
				<table class="largePicker">
					<tr>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
					</tr>
					<tr>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
					</tr>
					<tr>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
					</tr>
					<tr>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
					</tr>
					<tr>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
					</tr>
					<tr>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
					</tr>
					<tr>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
					</tr>
					<tr>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
					</tr>
					<tr>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
					</tr>
					<tr>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
						<td><div></div></td>
					</tr>
				</table>
				<div id="rightFunction">
					<button class="btn btn-success buttonMargin" id="saveButton">Publish Lego</button>
					<button class="btn btn-danger buttonMargin" id="eraseAll">Reset Lego</button>
				</div>
			</div>
		</div>
	</div>
  </body>
</html>
